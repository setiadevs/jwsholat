import{c as Z,a as S,t as M}from"../chunks/BuPbSRhO.js";import{i as ee}from"../chunks/BQl2g0dd.js";import{B as X,h as z,a2 as he,ab as _e,y as ye,b as be,k as p,J as ae,z as we,A as ie,C as K,c as W,a5 as ke,D as ve,a as de,F as xe,a9 as me,_ as Te,V as C,af as le,ag as Q,a0 as oe,ah as Ee,ai as De,aj as Ie,a8 as Se,ak as Pe,d as Ae,al as Ne,am as Ce,a3 as Me,f as te,v as P,w as E,t as q,q as re,s as ne,x as O,an as fe,ao as He,N as T}from"../chunks/BkgzjJ0Z.js";import{s as B}from"../chunks/BCjb5LZe.js";import{p as $,i as G}from"../chunks/BjzTUycU.js";import{o as Le}from"../chunks/DjahXDfk.js";function Oe(o,e){return e}function Re(o,e,a,r){for(var u=[],f=e.length,n=0;n<f;n++)Ie(e[n].e,u,!0);var i=f>0&&u.length===0&&a!==null;if(i){var l=a.parentNode;Se(l),l.append(a),r.clear(),L(o,e[0].prev,e[f-1].next)}Pe(u,()=>{for(var d=0;d<f;d++){var t=e[d];i||(r.delete(t.k),L(o,t.prev,t.next)),Ae(t.e,!i)}})}function ze(o,e,a,r,u,f=null){var n=o,i={flags:e,items:new Map,first:null};{var l=o;n=z?X(he(l)):l.appendChild(_e())}z&&ye();var d=null,t=!1,_=ae(()=>{var s=a();return Te(s)?s:s==null?[]:me(s)});be(()=>{var s=p(_),g=s.length;if(t&&g===0)return;t=g===0;let c=!1;if(z){var D=n.data===we;D!==(g===0)&&(n=ie(),X(n),K(!1),c=!0)}if(z){for(var I=null,m,b=0;b<g;b++){if(W.nodeType===8&&W.data===ke){n=W,c=!0,K(!1);break}var H=s[b],A=r(H,b);m=pe(W,i,I,null,H,A,b,u,e,a),i.items.set(A,m),I=m}g>0&&X(ie())}z||Ge(s,i,n,u,e,r,a),f!==null&&(g===0?d?ve(d):d=de(()=>f(n)):d!==null&&xe(d,()=>{d=null})),c&&K(!0),p(_)}),z&&(n=W)}function Ge(o,e,a,r,u,f,n){var i=o.length,l=e.items,d=e.first,t=d,_,s=null,g=[],c=[],D,I,m,b;for(b=0;b<i;b+=1){if(D=o[b],I=f(D,b),m=l.get(I),m===void 0){var H=t?t.e.nodes_start:a;s=pe(H,e,s,s===null?e.first:s.next,D,I,b,r,u,n),l.set(I,s),g=[],c=[],t=s.next;continue}if(Ue(m,D,b),(m.e.f&Q)!==0&&ve(m.e),m!==t){if(_!==void 0&&_.has(m)){if(g.length<c.length){var A=c[0],N;s=A.prev;var F=g[0],U=g[g.length-1];for(N=0;N<g.length;N+=1)ue(g[N],A,a);for(N=0;N<c.length;N+=1)_.delete(c[N]);L(e,F.prev,U.next),L(e,s,F),L(e,U,A),t=A,s=U,b-=1,g=[],c=[]}else _.delete(m),ue(m,t,a),L(e,m.prev,m.next),L(e,m,s===null?e.first:s.next),L(e,s,m),s=m;continue}for(g=[],c=[];t!==null&&t.k!==I;)(t.e.f&Q)===0&&(_??(_=new Set)).add(t),c.push(t),t=t.next;if(t===null)continue;m=t}g.push(m),s=m,t=m.next}if(t!==null||_!==void 0){for(var j=_===void 0?[]:me(_);t!==null;)(t.e.f&Q)===0&&j.push(t),t=t.next;var J=j.length;if(J>0){var Y=i===0?a:null;Re(e,j,Y,l)}}oe.first=e.first&&e.first.e,oe.last=s&&s.e}function Ue(o,e,a,r){De(o.v,e),o.i=a}function pe(o,e,a,r,u,f,n,i,l,d){var t=(l&Ne)!==0,_=(l&Ce)===0,s=t?_?C(u):le(u):u,g=(l&Ee)===0?n:le(n),c={i:g,v:s,k:f,a:null,e:null,prev:a,next:r};try{return c.e=de(()=>i(o,s,g,d),z),c.e.prev=a&&a.e,c.e.next=r&&r.e,a===null?e.first=c:(a.next=c,a.e.next=c.e),r!==null&&(r.prev=c,r.e.prev=c.e),c}finally{}}function ue(o,e,a){for(var r=o.next?o.next.e.nodes_start:a,u=e?e.e.nodes_start:a,f=o.e.nodes_start;f!==r;){var n=Me(f);u.before(f),f=n}}function L(o,e,a){e===null?o.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}var je=M('<p class="mb-2 text-base-content/80"><strong class="badge badge-primary badge-outline"> </strong></p>');function Be(o,e){let a=$(e,"city",8,""),r=$(e,"province",8,"");var u=Z(),f=te(u);{var n=i=>{var l=je(),d=P(l),t=P(d);E(d),E(l),q(()=>B(t,`${a()??""}, ${r()??""}`)),S(i,l)};G(f,i=>{a()&&r()&&i(n)})}S(o,u)}var Ve=M('<p class="mb-2">Waktu Saat Ini: <strong class="font-mono"> </strong></p>');function We(o,e){re(e,!1);let a=$(e,"currentTime",24,()=>new Date);ee();var r=Ve(),u=O(P(r)),f=P(u,!0);E(u),E(r),q(n=>B(f,n),[()=>a().toLocaleTimeString()],ae),S(o,r),ne()}var $e=M('<div class="alert alert-info mb-4"><strong>Sholat Berikutnya:</strong> </div>');function qe(o,e){re(e,!1);let a=$(e,"nextPrayer",8,null);ee();var r=Z(),u=te(r);{var f=n=>{var i=$e(),l=O(P(i));E(i),q(d=>B(l,` ${d??""} - ${a().time??""}`),[()=>a().name.charAt(0).toUpperCase()+a().name.slice(1)],ae),S(n,i)};G(u,n=>{a()&&n(f)})}S(o,r),ne()}var Fe=M('<tr><td class="capitalize"> </td><td class="font-mono"> </td></tr>'),Je=M('<table class="table table-zebra w-full mb-4"><thead><tr><th class="bg-base-200">Ibadah</th><th class="bg-base-200">Waktu</th></tr></thead><tbody></tbody></table>'),Ye=M('<div class="alert alert-warning"><p>Tidak ada jadwal sholat untuk tanggal ini.</p></div>');function ce(o,e){let a=$(e,"prayerTimes",8,null);var r=Z(),u=te(r);{var f=i=>{var l=Je(),d=O(P(l));ze(d,5,()=>Object.entries(a()),Oe,(t,_)=>{let s=()=>p(_)[0],g=()=>p(_)[1];var c=Fe(),D=P(c),I=P(D,!0);E(D);var m=O(D),b=P(m,!0);E(m),E(c),q(()=>{B(I,s()),B(b,g())}),S(t,c)}),E(d),E(l),S(i,l)},n=i=>{var l=Ye();S(i,l)};G(u,i=>{a()?i(f):i(n,!1)})}S(o,r)}var Xe=M('<p class="text-base-content/70 flex items-center gap-2"><span class="loading loading-spinner loading-md"></span> Memuat lokasi dan jadwal sholat...</p>'),Ke=M('<div class="alert alert-error my-2"><span> </span></div>'),Qe=M('<main class="container mx-auto max-w-lg p-4 mt-8 bg-base-100 rounded-xl shadow-lg"><h1 class="text-2xl font-bold mb-2 text-primary">Jadwal Sholat</h1> <!> <!> <!> <!></main>');function sa(o,e){re(e,!1);const a=C();let r=null,u=null,f=C([]),n=C(""),i=C(""),l=C(!0),d=C(""),t=C(new Date().toISOString().split("T")[0]),_=C(new Date),s=C(null);async function g(v,h){const k=`https://waktu-sholat-huso.vercel.app/prayer?latitude= ${v}&longitude=${h}`,w=await fetch(k);if(!w.ok)throw new Error("Gagal mengambil jadwal sholat");const y=await w.json();T(f,y.prayers),T(n,y.name),T(i,y.province.name)}async function c(v,h){const k=`https://nominatim.openstreetmap.org/reverse?format=json&lat= ${v}&lon=${h}`,w=await fetch(k);if(!w.ok)throw new Error("Gagal mendapatkan informasi lokasi");const x=(await w.json()).address;T(n,x.city||x.town||x.village||"Lokasi Tidak Dikenal"),T(i,x.state||x.region||x.province||"Provinsi Tidak Dikenal")}async function D(){T(l,!0),T(d,"");try{const v=await new Promise((h,k)=>navigator.geolocation.getCurrentPosition(h,k));r=v.coords.latitude,u=v.coords.longitude,await g(r,u),await c(r,u)}catch(v){console.error(v),T(d,"Gagal mendeteksi lokasi Anda. Pastikan izin lokasi diaktifkan.")}finally{T(l,!1)}}function I(){const[v,h,k]=p(t).split("-"),w=`${v}-${Number(h)}-${Number(k)}`;return p(f).find(y=>y.date===w)}function m(v){const h=new Date,k=h.getHours(),w=h.getMinutes();for(const[y,x]of Object.entries(v)){const[R,V]=x.split(":").map(Number);if(k<R||k===R&&w<V)return{name:y,time:x}}return null}function b(v){const h=new Date,k=h.getHours(),w=h.getMinutes();Object.entries(v).forEach(([y,x])=>{const[R,V]=x.split(":").map(Number);if(k===R&&w===V){const se=`notified_${h.toDateString()}_${y}`;localStorage.getItem(se)||(alert(`Waktu ${y.charAt(0).toUpperCase()+y.slice(1)} Telah Tiba!`),localStorage.setItem(se,"true"))}})}Le(()=>{D(),setInterval(()=>{T(_,new Date),T(t,new Date().toISOString().split("T")[0])},1e3)}),fe(()=>(p(f),p(t)),()=>{T(a,p(f).length>0&&p(t)?I():void 0)}),fe(()=>p(a),()=>{p(a)&&(T(s,m(p(a).time)),b(p(a).time))}),He(),ee();var H=Qe(),A=O(P(H),2);{var N=v=>{var h=Xe();S(v,h)},F=(v,h)=>{{var k=y=>{var x=Ke(),R=P(x),V=P(R,!0);E(R),E(x),q(()=>B(V,p(d))),S(y,x)},w=y=>{Be(y,{get city(){return p(n)},get province(){return p(i)}})};G(v,y=>{p(d)?y(k):y(w,!1)},h)}};G(A,v=>{p(l)?v(N):v(F,!1)})}var U=O(A,2);We(U,{get currentTime(){return p(_)}});var j=O(U,2);qe(j,{get nextPrayer(){return p(s)}});var J=O(j,2);{var Y=v=>{ce(v,{get prayerTimes(){return p(a).time}})},ge=(v,h)=>{{var k=w=>{ce(w,{prayerTimes:null})};G(v,w=>{p(l)||w(k)},h)}};G(J,v=>{!p(l)&&p(a)?v(Y):v(ge,!1)})}E(H),S(o,H),ne()}export{sa as component};
